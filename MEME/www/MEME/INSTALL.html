<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>MEME4 Installation Instructions</title>
</head>
<body>
<center>
<h2>MEME4 INSTALLATION INSTRUCTIONS (06/27/2005)</h2>
</center>
<hr width="100%">
<h3>Contents</h3>
There are four sections:<br>
<ol>
  <li><a href="#suggested">Suggested Installation Parameters</a></li>
  <li><a href="#preparing">Preparation for Installation</a><br>
  </li>
  <li><a href="#installing">Installation Checklist</a></li>
  <li><a href="#updating">Update Checklist</a></li>
  <li><a href="#processes">MEME Processes</a><br>
  </li>
  <li><a href="#qa">Post-installation QA Checklist</a><br>
  </li>
</ol>
<br>
<h3><a name="suggested"></a>Suggested Installation Parameters</h3>
The target machine must satisfy a certain minimal set of hardware
and software configuration requrements.&nbsp; * indicates a requirement.<br>
<ul>
  <b>Hardware:</b> <li>4GB physical memory (with at least this much VM
allowed, more is preferred)</li>
  <li>100GB free disk space (more is preferred)<br>
  </li>
  <br>
  <b>Software:</b> <li>A UNIX style operating system (Solaris, Linux
(e.g. Red Hat Advanced Server edition), etc) with <span
 style="font-family: monospace;">csh</span> and <span
 style="font-family: monospace;">sh</span> shells installed.</li>
  <li>*Oracle 9.2<br>
  </li>
  <li>*Perl5.8 (or higher) with DBI, DBD::Oracle able to connect to
Oracle 9.2</li>
  <li>*Java 1.4.2</li>
  <li>*MD5 (put in /site/bin/md5)</li>
  <li>*Apache (2.0 recommended) </li>
  <li>*Jakarta Tomcat (4.1+ recommended)</li>
  <li>*Zip</li>
</ul>
<h3><a name="preparing"></a>Preparation for Installation<br>
</h3>
These steps should be performed first.
<ol>
  <li>Create a database (e.g. <span style="font-family: monospace;">memedb</span>)
with at least 10GB of data files (<span
 style="color: rgb(204, 0, 0); font-weight: bold;">*not necessary if
MID already exists</span>)<br>
  </li>
  <li>Configure oracle on target machine (<span
 style="color: rgb(204, 0, 0); font-weight: bold;">*not necessary if
MID already exists</span>)
    <ol type="a">
      <li>Edit <span style="font-family: monospace;">$ORACLE_HOME/network/admin/tnsnames.ora</span>
        <ul>
          <li>Create tns name (e.g. <span
 style="font-family: monospace;">memedb</span>)</li>
          <li>Create tns name (e.g. <span
 style="font-family: monospace;">&lt;machine&gt;_memedb</span>)</li>
        </ul>
      </li>
      <li>Create an Oracle MTH schema (<span
 style="color: rgb(204, 0, 0); font-weight: bold;">*not necessary if
MID already exists</span>)<br>
Grants and roles include:<br>
        <span style="font-family: monospace;">GRANT CREATE SEQUENCE TO
"MTH";</span><br style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT CREATE TABLE TO
"MTH";</span><br style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT SELECT ANY TABLE TO
"MTH" WITH ADMIN OPTION;</span><br style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT UNLIMITED
TABLESPACE TO "MTH";</span><br style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT SELECT ON
"SYS"."PUBLICSYN" TO "MTH" WITH GRANT OPTION;</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT
"AQ_ADMINISTRATOR_ROLE" TO "MTH";</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT "AQ_USER_ROLE" TO
"MTH";</span><br style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT "CONNECT" TO "MTH";</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT "DBA" TO "MTH";</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT
"DELETE_CATALOG_ROLE" TO "MTH";</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT
"EXECUTE_CATALOG_ROLE" TO "MTH";</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT "RESOURCE" TO "MTH";</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT
"SELECT_CATALOG_ROLE" TO "MTH";</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT ALTER TABLESPACE TO
"MTH";</span><br style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT SELECT ANY
DICTIONARY TO "MTH";&nbsp; </span><br style="font-family: monospace;">
        <span style="font-family: monospace;">ALTER USER "MTH" DEFAULT
ROLE ALL;</span><br>
      </li>
      <li>Create an Oracle MEOW schema (<span
 style="color: rgb(204, 0, 0); font-weight: bold;">*not necessary if
MID already exists</span>)<br>
Grants and roles include:<br>
        <span style="font-family: monospace;">GRANT UNLIMITED
TABLESPACE TO "MEOW";</span><br style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT "CONNECT" TO "MEOW";</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT "DBA" TO "MEOW";</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">GRANT "RESOURCE" TO
"MEOW";</span><br style="font-family: monospace;">
        <span style="font-family: monospace;">ALTER USER "MEOW" DEFAULT
ROLE ALL;</span></li>
      <li>Additional Roles: (<span
 style="color: rgb(204, 0, 0); font-weight: bold;">*not necessary if
MID already exists</span>)<br>
        <span style="font-family: monospace;">create role MID_SUPERUSER;</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">create role MID_USER;</span><br
 style="font-family: monospace;">
        <br style="font-family: monospace;">
        <span style="font-family: monospace;">-- Initializing
MID_SUPERUSER role</span><br style="font-family: monospace;">
        <span style="font-family: monospace;">grant CONNECT to
MID_SUPERUSER with admin option;</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">grant RESOURCE to
MID_SUPERUSER with admin option;</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">grant DBA to
MID_SUPERUSER with admin option;</span><br
 style="font-family: monospace;">
        <br style="font-family: monospace;">
        <span style="font-family: monospace;">-- Initializing MID_USER;</span><br
 style="font-family: monospace;">
        <span style="font-family: monospace;">grant CONNECT to MID_USER;</span><br>
        <br>
      </li>
      <li>Grant ALL on all MTH and MEOW tables to MID_USER. (<span
 style="color: rgb(204, 0, 0); font-weight: bold;">*not necessary if
MID already exists</span>)<br>
        <span style="width: 500px;">DECLARE<br>
CURSOR cur IS SELECT table_name FROM user_tables;<br>
cv cur%ROWTYPE;<br>
        <span class="hl">BEGIN</span><br>
OPEN cur;<br>
LOOP<br>
FETCH cur INTO cv;<br>
EXIT WHEN cur%NOTFOUND;<br>
EXECUTE IMMEDIATE '<span class="hl">GRANT</span> ALL ON ' ||
cv.table_name || ' TO MID_USER';<br>
        <span class="hl">END</span> LOOP;<br>
        <span class="hl">END</span>;<br>
/</span><br>
      </li>
      <li>Initialization parameters: (<span
 style="color: rgb(204, 0, 0); font-weight: bold;">*not necessary if
MID already exists</span>)</li>
      <blockquote>
        <pre>utl_file_dir=*<br></pre>
      </blockquote>
    </ol>
  </li>
  <li>Synchronize www directory from <span
 style="font-family: monospace;">smis.nlm.nih.gov</span>. On the smis
machine run the zip command (from meow document root).
    <ul>
      <li><span style="font-family: monospace;">buildzip.csh</span> (in
        <span style="font-family: monospace;">/export/home/meow</span>)<span
 style="font-family: monospace;"><br>
        </span></li>
      <li>copy <span style="font-family: monospace;">www.zip</span>
back to <span style="font-family: monospace;">$MEME_HOME/www</span></li>
      <li>unzip in <span style="font-family: monospace;">$MEME_HOME/www<br>
        <br>
        </span></li>
    </ul>
  </li>
  <li>Build <span style="font-family: monospace;">$MEME_HOME/meme.zip</span>
using <span style="font-family: monospace;">$MEME_HOME/bin/buildzip.csh</span>.</li>
</ol>
<h3><a name="installing"></a>Installing MEME <br>
</h3>
These steps should be performed on the target machine.
<ol>
  <li> Create a <span style="font-family: monospace;">$MEME_HOME</span>
directory on your local machine. FTP <span
 style="font-family: monospace;">meme.zip</span> to this directory and
unzip it.</li>
  <ol>
    <li>Configure user environment (.cshrc) to set $MEME_HOME upon login<br>
    </li>
  </ol>
  <br>
  <li>Load schema and packages. For example, (<span
 style="color: rgb(204, 0, 0); font-weight: bold;">*not necessary if
MID already exists</span>)
    <blockquote>
      <pre>sqlplus user/pwd@db &lt;&lt; EOF<br>@$MEME_HOME/sql/tables<br>@$MEME_HOME/sql/indexes<br>@$MEME_HOME/sql/views<br>@$MEME_HOME/sql/synonyms<br>@$MEME_HOME/sql/packages<br>EOF<br></pre>
    </blockquote>
  </li>
  <li>Load MEOW tables from EMS. For example, (<span
 style="color: rgb(204, 0, 0); font-weight: bold;">*not necessary if
MID already exists</span>)
    <blockquote>
      <pre>cd /site/umls/oracle/ems-2.1/sql<br>foreach f (`ls *sql`)<br>  sqlplus $mu@$db &lt;&lt; EOF<br>@$f<br>EOF<br>end<br></pre>
    </blockquote>
  </li>
  <br>
  <li>Load data from <span style="font-family: monospace;">$MEME_HOME/dump</span>
directory. Use <span style="font-family: monospace;">$MEME_HOME/dump/load.csh</span>
(edit to set db name). (<span
 style="color: rgb(204, 0, 0); font-weight: bold;">*not necessary if
MID already exists</span>)</li>
  <ol>
    <li>Before loading, configure <span style="font-family: monospace;">ui_prefix</span>
and <span style="font-family: monospace;">ui_length</span> entries in
code_map.dat (set the prefixes and lengths for CUI, LUI, SUI, ISUI,
AUI, ATUI, RUI).<br>
    </li>
  </ol>
  <br>
  <li>Create links/directories. This is needed in order to make sure
certain expected paths exist.
    <blockquote>
      <pre>ln -s $MEME_HOME/etc/umls /etc/umls  (<span
 style="font-weight: bold;">This requires root access.</span>)<br>ln -s $MEME_HOME/site /site          (<span
 style="font-weight: bold;">This requires root access.</span>)<br>ln -s $JAVA_HOME/bin/java /site/bin/java<br>ln -s $JAVA_HOME/bin/jar /site/bin/jar<br>ln -s `which zip` /site/bin/zip<br>/bin/mkdir /site/java<br>ln -s $JAVA_HOME /site/java/jre<br>ln -s $JAVA_HOME /site/java/jdk<br></pre>
    </blockquote>
  </li>
  <br>
  <li>Create links for CGI tools. Here we link cgi tools to the <span
 style="font-family: monospace;">$MEME_HOME/cgi-bin</span> directory.
    <blockquote>
      <pre>ln -s /site/umls/oracle/scripts/styqa.pl $MEME_HOME/cgi-bin/styqa.pl<br>ln -s /site/umls/oracle/ems-2.1/src/ems.pl $MEME_HOME/cgi-bin/ems.pl<br>ln -s /site/umls/oracle/wms-2.1/src/wms.pl $MEME_HOME/cgi-bin/wms.pl<br>ln -s /site/umls/oracle/concept-reports/concept-report-mid.pl $MEME_HOME/cgi-bin/concept-report-mid.pl<br>ln -s $MEME_HOME/cgi-bin/concept-report-mid.pl $MEME_HOME/cgi-bin/concept-report-meme4.pl<br>ln -s /site/umls/oracle/scripts/oracle-sessions.pl $MEME_HOME/cgi-bin<br></pre>
    </blockquote>
  </li>
  <br>
  <li><a name="mid-services"></a>Edit UNIX startup services
files.&nbsp; <span style="font-weight: bold;">This requires root
access.</span>
    <ol type="a">
      <li><span style="font-family: monospace;">/etc/services</span>
(Add these lines):
        <blockquote>
          <pre>#<br># Local Metathesaurus Services<br>#<br>midsvcs             5125/tcp        # MID services<br></pre>
        </blockquote>
      </li>
      <li><span style="font-family: monospace;">/etc/inetd.conf</span>
(Add these lines):
        <blockquote>
          <pre>#<br># Local Metathesaurus Services<br>#<br>midsvcs stream tcp nowait nobody /site/umls/scripts/midsvcs-server.pl midsvcs-server.pl<br></pre>
        </blockquote>
      </li>
      <li>Edit the <span style="font-family: monospace;">/etc/umls/mid-services</span>
file for local settings.</li>
      <li>Edit the <span style="font-family: monospace;">/etc/umls/oracle.passwd</span>
file for the correct usernames and passwords.<br>
      </li>
      <li>Restart the service. Find the process id using <span
 style="font-family: monospace;">ps -ef | grep inetd</span>. As the <span
 style="font-family: monospace;">root</span> user send a HUP signal
using <span style="font-family: monospace;">kill -HUP &lt;process
id&gt;</span> </li>
    </ol>
  </li>
  <br>
  <li>Configure <span style="font-family: monospace;">$MEME_HOME/bin/meme.prop</span>.
Set these properties:
    <blockquote>
      <pre>meme.mid.service.host=&lt;machine name, e.g. cbiodev108.nci.nih.gov&gt;<br>meme.mid.service.port=5125<br>meme.smtp.host=&lt;machine name&gt;<br>meme.client.server.host=&lt;machine name&gt;<br>meme.env.MEME_HOME=&lt;$MEME_HOME&gt;<br>meme.env.ORACLE_HOME=&lt;$ORACLE_HOME&gt;<br></pre>
    </blockquote>
  </li>
  <br>
  <li>Configure <span style="font-family: monospace;">/site</span>
    <ul>
      <li>Link <span style="font-family: monospace;">/site/java/jre</span>
to current <span style="font-family: monospace;">$JAVA_HOME</span>
directory (1.4.2) (probably done in step 5 already)<br>
      </li>
      <li>Create links in <span style="font-family: monospace;">/site/bin</span>
for <span style="font-family: monospace;">jar</span>, <span
 style="font-family: monospace;">java</span> , <span
 style="font-family: monospace;">perl</span>, <span
 style="font-family: monospace;">perl5</span>, <span
 style="font-family: monospace;">perl5.005</span>, <span
 style="font-family: monospace;">perl58</span>.</li>
    </ul>
  </li>
  <br>
  <li>Configure HTTP Server &amp; Tomcat. There is a lot of
configuration needed to get authentication, CGI applications, and
webapps to work properly.&nbsp; <span style="font-weight: bold;">This
may require root access.</span>
    <ul>
      <li>Configure the user info (in <span
 style="font-family: monospace;">$APACHE/conf/httpd.conf</span>). For
example,
        <blockquote>
          <pre>User meme<br>Group other<br>SetEnv MEME_HOME /usr/d5/MEME4<br>SetEnv ORACLE_HOME /app/oracle/product/9.2.0<br></pre>
        </blockquote>
      </li>
      <li>Configure Timout. For example,
        <blockquote>
          <pre>Timeout 7200<br></pre>
        </blockquote>
      </li>
      <li>Configure document root to be <span
 style="font-family: monospace;">$MEME_HOME/www</span> in <span
 style="font-family: monospace;">$APACHE/conf/httpd.conf</span>. For
example,
        <blockquote>
          <pre>DocumentRoot "/usr/d5/MEME4/www"<br></pre>
        </blockquote>
      </li>
      <li>Add JNLP to <span style="font-family: monospace;">$APACHE/conf/mime.types</span>.
For example,
        <blockquote>
          <pre>application/x-java-jnlp-file    jnlp<br></pre>
        </blockquote>
      </li>
      <li>Configure CGI directories to point to <span
 style="font-family: monospace;">$MEME_HOME/cgi-bin</span>.
        <blockquote>
          <pre>ScriptAlias /cgi-bin/ <path to="" meme_home="">/cgi-bin/<br>ScriptAlias /cgi-oracle-meowusers/ <path
 to="" meme_home="">/cgi-bin/<br>ScriptAlias /cgi-oracle-nlmlti/ <path
 to="" meme_home="">/cgi-bin/<br>ScriptAlias /cgi-oracle-editors/ <path
 to="" meme_home="">/cgi-bin/<br>ScriptAlias /cgi-lti-oracle/ <path
 to="" meme_home="">/cgi-bin/<br>AddHandler cgi-script .cgi<br></path></path></path></path></path></pre>
        </blockquote>
      </li>
      <li>Make sure the CGI <span style="font-family: monospace;">&lt;Directory&gt;</span>
directive has
        <blockquote>
          <pre>Options FollowSymLinks<br></pre>
        </blockquote>
      </li>
      <li>Support server side includes. For example,
        <blockquote>
          <pre>&lt;IfModule mod_mime.c&gt;<br>...<br>    #<br>    # To use server-parsed HTML files<br>    #<br>    AddType text/html .shtml<br>    AddHandler server-parsed .shtml<br>...<br>&lt;/IfModule&gt;<br><br>&lt;Directory /&gt;<br>    Options FollowSymLinks +Includes<br>    AllowOverride None<br>&lt;/Directory&gt;<br></pre>
        </blockquote>
      </li>
      <li>Support <span style="font-family: monospace;">index.shtml</span>
as index page. For example,
        <blockquote>
          <pre>#<br># DirectoryIndex: Name of the file or files to use as a pre-written HTML<br># directory index.  Separate multiple entries with spaces.<br>#<br>&lt;IfModule mod_dir.c&gt;<br>    DirectoryIndex index.html index.shtml<br>&lt;/IfModule&gt;<br></pre>
        </blockquote>
      </li>
      <li>Configure authentication. For each <span
 style="font-family: monospace;">Directory</span> directive do
something like this:
        <blockquote>
          <pre>    Order Deny,Allow<br>    Deny from all<br>        AuthType Basic<br>        AuthName "Metathesaurus Editors Online World"<br>        AuthUserFile /etc/umls/meow.passwd<br>        AuthGroupFile /etc/umls/meow.group<br>        require group meowusers<br>        deny from redoubt<br>        satisfy any<br></pre>
        </blockquote>
      </li>
      <li>Connect Apache, Tomcat users.&nbsp; If you want to use the
manager application, you will need a tomcat-users.xml file like this:<br>
        <pre>&lt;?xml version='1.0' encoding='utf-8'?&gt;<br>&lt;tomcat-users&gt;<br>  &lt;role rolename="manager"/&gt;<br>  &lt;user username="mth" password="da3f16e8581e271a13a48dc4468cf1e7" roles="manager"/&gt;<br>&lt;/tomcat-users&gt;<br><br></pre>
      </li>
      <li>Connect Apache to Tomcat. First, create a
$TOMCAT/webapps/webapps-meme.xml file like this:
        <blockquote>
          <pre>&lt;Context path="/webapps-meme" docBase="<path to=""
 meme_home="">/webapps-meme"<br>        debug="0"&gt;<br>          &lt;Logger className="org.apache.catalina.logger.FileLogger"<br>                     prefix="localhost_webapps-meme_log." suffix=".txt"<br>                  timestamp="true"/&gt;<br>&lt;/Context&gt;<br></path></pre>
        </blockquote>
Next, edit <span style="font-family: monospace;">httpd.conf</span> to
connect to tomcat.
        <blockquote>
          <pre>LoadModule jk_module          libexec/mod_jk.so<br>AddModule mod_jk.c<br><br># statements from the tomcat generated mod_jk.conf-auto<br># ( /usr/local/jakarta-tomcat-3.2.1/conf/mod_jk.conf-bw )<br># were placed here - an Include statement was not used because the<br># LoadModule and and AddModule statements for mod_jk need to go before the<br># corresponding statements for mod_rewrite in the above sections<br>#<br>JkWorkersFile /usr/local/apache/conf/workers.properties<br>JkLogFile     /usr/local/apache/logs/mod_jk.log<br>#JkLogLevel    warn<br>JkLogLevel    info<br>JkMount /*.jsp ajp13<br>JkMount /servlet/* ajp13<br>JkMount /admin/* ajp13<br>JkMount /manager/* ajp13<br>JkMount /examples/* ajp13<br>JkMount /webapps-meme/* ajp13<br>JkMount /webapps-mrd/* ajp13<br></pre>
        </blockquote>
Next, edit <span style="font-family: monospace;">workers.properties</span>.
        <blockquote>
          <pre>workers.tomcat_home=/usr/local/tomcat4<br>workers.java_home=/usr/java<br>ps=/<br>worker.list=ajp12, ajp13<br>worker.ajp12.port=5007<br>worker.ajp12.host=localhost<br>worker.ajp12.type=ajp12<br>worker.ajp12.lbfactor=1<br>worker.ajp13.port=5009<br>worker.ajp13.host=localhost<br>worker.ajp13.type=ajp13<br>worker.ajp13.lbfactor=1<br>worker.loadbalancer.type=lb<br>worker.loadbalancer.balanced_workers=ajp12, ajp13<br>worker.inprocess.type=jni<br>worker.inprocess.class_path=$(workers.tomcat_home)$(ps)classes<br>worker.inprocess.class_path=$(workers.tomcat_home)$(ps)lib$(ps)jaxp.jar<br>worker.inprocess.class_path=$(workers.tomcat_home)$(ps)lib$(ps)parser.jar<br>worker.inprocess.class_path=$(workers.tomcat_home)$(ps)lib$(ps)jasper.jar<br>worker.inprocess.class_path=$(workers.tomcat_home)$(ps)lib$(ps)servlet.jar<br>worker.inprocess.class_path=$(workers.tomcat_home)$(ps)lib$(ps)webserver.jar<br>worker.inprocess.class_path=$(workers.java_home)$(ps)lib$(ps)tools.jar<br>worker.inprocess.cmd_line=-config<br>worker.inprocess.cmd_line=$(workers.tomcat_home)/conf/jni_server.xml<br>worker.inprocess.cmd_line=-home<br>worker.inprocess.cmd_line=$(workers.tomcat_home)<br>worker.inprocess.jvm_lib=$(workers.java_home)$(ps)jre$(ps)bin$(ps)classic$(ps)jvm.dll<br>worker.inprocess.stdout=$(workers.tomcat_home)$(ps)inprocess.stdout<br>worker.inprocess.stderr=$(workers.tomcat_home)$(ps)inprocess.stderr<br>worker.inprocess.sysprops=tomcat.home=$(workers.tomcat_home)<br></pre>
        </blockquote>
      </li>
    </ul>
  </li>
  <br>
  <li>Put <span style="font-family: monospace;">$MEME_HOME/java/meme.jar</span>
and <span style="font-family: monospace;">$MEME_HOME/bin/meme.prop</span>
in needed places (this may overwrite existing files).
    <blockquote>
      <pre>/bin/cp -f $MEME_HOME/java/meme.jar $MEME_HOME/www/jaws/jekyll/lib/meme.jar<br>/bin/cp -f $MEME_HOME/java/meme.jar $MEME_HOME/webapps-meme/WEB-INF/lib/meme.jar<br><br>/bin/cp -f $MEME_HOME/bin/meme.prop $MEME_HOME/www/MEME/Data/meme.prop<br>/bin/cp -f $MEME_HOME/bin/meme.prop $MEME_HOME/webapps-meme/WEB-INF/classes/meme.prop<br>/bin/rm -r -f /tmp/bundles /tmp/meme.prop<br>mkdir /tmp/bundles<br>/bin/cp $MEME_HOME/bin/meme.prop /tmp/bundles<br>/bin/cp $MEME_HOME/bin/meme.prop /tmp<br>pushd /tmp<br>jar -cvf $MEME_HOME/www/jaws/jekyll/lib/config.jar bundles/meme.prop meme.prop<br>popd<br>/bin/rm -r -f /tmp/bundles /tmp/meme.prop<br></pre>
    </blockquote>
  </li>
  <li>Prep Jekyll JNLP. Run <span style="font-family: monospace;">$MEME_HOME/www/jaws/jekyll/makejnlp.csh</span>
to sign the necessary jar files. If necessary, you can prep a keystore
using the following steps:
    <ol type="a">
      <li>Remove keystore:
        <blockquote>
          <pre>/bin/rm -f $MEME_HOME/java/myKeystore<br></pre>
        </blockquote>
      </li>
      <li>Create keystore:
        <blockquote>
          <pre>keytool -genkey -keystore $MEME_HOME/java/myKeystore -alias mth<br></pre>
        </blockquote>
      </li>
      <li>Remove keystore:
        <blockquote>
          <pre>/bin/rm -f $MEME_HOME/java/myKeystore<br></pre>
        </blockquote>
      </li>
      <li>Create a certificate
        <blockquote>
          <pre>keytool -selfcert -alias mth -keystore $MEME_HOME/java/myKeystore<br></pre>
        </blockquote>
      </li>
      <li>Test it.
        <blockquote>
          <pre>keytool -list -keystore $MEME_HOME/java/myKeystore<br></pre>
        </blockquote>
It should list something like:
        <pre><blockquote><br>        Keystore type: jks<br>        Keystore provider: SUN<br><br>        Your keystore contains 1 entry:<br><br>        myself, Tue Jan 23 19:29:32 PST 2001, keyEntry,<br>        Certificate fingerprint (MD5):<br>        C2:E9:BF:F9:D3:DF:4C:8F:3C:5F:22:9E:AF:0B:42:9D<br></blockquote></pre>
      </li>
    </ol>
  </li>
  <br>
  <li><a name="lvg">Install and Configure LVG. <br>
    <br>
First, install the current version of LVG (e.g. 2005) and create a
"current" link. For example,<br>
    <br>
    <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; ln
-s /site/package/lvg/current</span> <span
 style="font-family: monospace;">/site/package/lvg/lvg2005</span><br>
    <br>
Edit these files: <br>
    <br>
    </a>
    <ul>
      <li><span style="font-family: monospace;">/site/package/lvg/current/bin/luiNorm</span></li>
      <li><span style="font-family: monospace;">/site/package/lvg/current/bin/norm</span></li>
      <li><span style="font-family: monospace;">/site/package/lvg/current/bin/wordind</span></li>
    </ul>
    <br>
Use these settings:
    <blockquote>
      <pre>JAVA=/site/bin/java<br>CLASSPATH="/site/package/lvg/current:/site/package/lvg/current/lib/lvg2005dist.jar:"<br></pre>
    </blockquote>
Then edit: <br>
&nbsp;<br>
    <ul>
      <li><span style="font-family: monospace;">/site/package/lvg/current/data/config/lvg.properties</span></li>
    </ul>
&nbsp; <br>
Use these settings:
    <blockquote>
      <pre>LVG_DIR=/site/package/lvg/current/<br></pre>
    </blockquote>
Then, create "wordind":
    <blockquote>
      <pre>/bin/cp -f /site/package/lvg/current/bin/wordInd /site/package/lvg/current/bin/wordind<br></pre>
    </blockquote>
Next, edit your environment to set the <span
 style="font-family: monospace;">$NLS</span> variable.
    <blockquote>
      <pre>setenv NLS /site/package/lvg/current<br></pre>
    </blockquote>
Now, start the LVG server.
    <blockquote>
      <pre>/site/umls/lvg/hsqldbserver/LVGServer.pl -p 16001 -g<br></pre>
    </blockquote>
  </li>
  <br>
  <li>Configure CGI scripts with proper <span
 style="font-family: monospace;">$MEME_HOME</span> and <span
 style="font-family: monospace;">$ORACLE_HOME</span> and other paths.<br>
    <blockquote>
      <pre>% $MEME_HOME/bin/replace.pl '/d1/app/oracle/product/8.1.7' "$ORACLE_HOME" *<br>% $MEME_HOME/bin/replace.pl '/d5/MEME4' "$MEME_HOME" *<br>% chmod 755 *cgi<br></pre>
    </blockquote>
Do not forget to edit /site/umls/oracle/ems-2.1/src/matrixinitlog.pl to
set the machine list and <span style="font-family: monospace;">$MEME_HOME</span>.
  </li>
  <br>
  <li>Configure CGI applications.&nbsp; This is really only for a <span
 style="font-weight: bold;">new</span> installation.
    <ul>
      <li>Write <span style="font-family: monospace;">/site/umls/ems/config/ems.config</span>.
For example,
        <blockquote>
          <pre># Access control for the EMS<br># Format:<br># action|user/group|deny or allow|comment<br># e.g.,<br># home|*|allow<br># stamp|nlmlti|allow<br><br># To turn off all access, use: *|*|deny|System down for insertion<br># To turn on all access, use: *|*|allow<br>home|*|allow<br>db|*|allow<br>*|*|allow<br></pre>
        </blockquote>
      </li>
      <li>Edit <span style="font-family: monospace;">/site/umls/ems/config/ME.config</span>.
For example,
        <blockquote>
          <pre># Configuration for ME bins<br># Fields are:<br># ME Bin|Editable|Description|generator_script|order_script|<br>#   contents|chem_algo<br><br># ME Bin: the name of bin, e.g., demotions, badsty, etc.<br># editable: Y if this is contents are editable, N otherwise<br># Description: a short description for the bin<br># generator_script: the name of the script that generates concept clusters for this bin<br># order_script: path to script that orders clusters in the bin<br># contents: Contents of bin are chemicals (C), non-chemicals (N) or both (M).<br># chem_algo: All concepts in a cluster are chemicals (A, default), one or more (O)<br><br># Bin order is as specified in this file<br><br>#--------------- DO NOT CHANGE THESE --------------<br>testconcepts|N|Concepts used for testing|gen_testconcepts.pl||M<br>demotions|Y|Demotions|gen_dem.pl|order_dem.pl|M|O|<br>embryos|N|Contains embryo concepts|gen_embryo.pl||M<br>norelease|N|Concepts with all atoms having tobereleased in ('N', 'n')|gen_norelease.pl||M<br>reviewed|N|Concepts with status=R that have been reviewed|gen_reviewed.pl||M<br>#--------------------------------------------------<br><br># Put additional bins here<br><br>#--------------- DO NOT CHANGE THIS ---------------<br>leftovers|Y|Unclassified concepts|gen_leftovers.pl||M<br>#--------------------------------------------------<br><br></pre>
        </blockquote>
      </li>
      <li>Edit <span style="font-family: monospace;">/site/umls/ems/config/QA.config</span></li>
      <li>Edit <span style="font-family: monospace;">/site/umls/ems/config/AH.config</span></li>
      <li>Edit all related scripts to change <span
 style="font-family: monospace;">/d3/worklists</span> to <span
 style="font-family: monospace;">/site/umls/ems/worklists</span>. For
example,
        <blockquote>
          <pre>cd /site/umls<br>/bin/grep -l /d3/worklists `find . -name "*"` &gt;! x<br>replace.pl "/d3/worklists" "/site/umls/ems/worklists" `cat x`<br>/bin/rm -f x<br></pre>
        </blockquote>
      </li>
      <li>Replace all references to <span
 style="font-family: monospace;">/d3/ems</span> in <span
 style="font-family: monospace;">/site/umls</span> with <span
 style="font-family: monospace;">/site/umls/ems</span>.
        <blockquote>
          <pre>cd /site/umls<br>/bin/grep -l /d3/ems `find . -name "*"` &gt;! x<br>replace.pl /d3/ems /site/umls/ems `cat x`<br>/bin/rm -f x<br></pre>
        </blockquote>
      </li>
      <li>Replace all references to <span
 style="font-family: monospace;">/site2/httpd-data/meow.group</span>
with <span style="font-family: monospace;">/etc/umls/meow.group</span>.
        <blockquote>
          <pre>cd /site/umls<br>/bin/grep -l /site2/httpd-data/meow.group `find . -name "*"` &gt;! x<br>replace.pl /site2/httpd-data/meow.group /etc/umls/meow.group `cat x`<br>/bin/rm -f x<br></pre>
        </blockquote>
      </li>
      <li>Replace all references to <span
 style="font-family: monospace;">/site2/umls-data/concept-report-data
with /site/umls/ems/data</span>. Then build sources.txt
        <blockquote>
          <pre>cd /site/umls/oracle/concept-reports<br>/bin/grep -l /site2/umls-data/concept-report-data `find . -name "*"` &gt;! x<br>replace.pl /site2/umls-data/concept-report-data /site/umls/ems/data `cat x`<br>chmod 755 *pl<br>/bin/rm -f x<br># do this AFTER the database is loaded<br>cd /site/umls/ems/data<br>/site/umls/oracle/scripts/dump_table.pl -u $user -d $db -q "select source from source_rank" &gt;! sources.txt<br></pre>
        </blockquote>
      </li>
      <li>Replace all references to <span
 style="font-family: monospace;">/d5/MEME4</span> with <span
 style="font-family: monospace;">$MEME_HOME</span>.
        <blockquote>
          <pre>cd /site/umls<br>/bin/grep -l /d5/MEME4 `find . -name "*"` &gt;! x<br>replace.pl /d5/MEME4 $MEME_HOME `cat x`<br>chmod 775 `cat x`<br>/bin/rm -f x<br>cd $MEME_HOME/cgi-bin<br>/bin/grep -l /d5/MEME4 `find . -name "*"` &gt;! x<br>replace.pl /d5/MEME4 $MEME_HOME `cat x`<br>chmod 775 `cat x`<br>/bin/rm -f x<br></pre>
        </blockquote>
      </li>
      <li>Replace all references to <span
 style="font-family: monospace;">/export/home/meow</span> with <span
 style="font-family: monospace;">$MEME_HOME/www</span>.
        <blockquote>
          <pre>cd /site/umls<br>/bin/grep -l /export/home/meow `find . -name "*"` &gt;! x<br>replace.pl /export/home/meow $MEME_HOME/www `cat x`<br>chmod 775 `cat x`<br>/bin/rm -f x<br>cd $MEME_HOME/cgi-bin<br>/bin/grep /export/home/meow `find . -name "*"` &gt;! x<br>replace.pl /export/home/meow $MEME_HOME/www `cat x`<br>chmod 775 `cat x`<br>/bin/rm -f x<br></pre>
        </blockquote>
      </li>
      <li>Replace all references to <span
 style="font-family: monospace;">/ems-2.0</span> with <span
 style="font-family: monospace;">/ems-2.1</span>.
        <blockquote>
          <pre>cd /site/umls<br>/bin/grep -l /ems-2.0 `find . -name "*"` &gt;! x<br>replace.pl "/ems-2.0" "/ems-2.1" `cat x`<br>/bin/rm -f x<br></pre>
        </blockquote>
      </li>
      <li>Replace all references to <span
 style="font-family: monospace;">/wms-2.0</span> with <span
 style="font-family: monospace;">/wms-2.1</span>.
        <blockquote>
          <pre>cd /site/umls<br>/bin/grep -l /wms-2.0 `find . -name "*"` &gt;! x<br>replace.pl "/wms-2.0" "/wms-2.1" `cat x`<br>/bin/rm -f x<br></pre>
        </blockquote>
      </li>
      <li>Replace all references to <span
 style="font-family: monospace;">/</span> with <span
 style="font-family: monospace;">/</span>.
        <blockquote>
          <pre>cd /site/umls<br>/bin/grep -l / `find . -name "*"` &gt;! x<br>replace.pl "/" "/" `cat x`<br>/bin/rm -f x<br></pre>
        </blockquote>
      </li>
      <li>Make all replaced scripts executable. For example,
        <blockquote>
          <pre>cd /site/umls<br>chmod 755 `find . -name "*pl"`<br></pre>
        </blockquote>
      </li>
      <li>Ensure <span style="font-family: monospace;">Proc::Simple</span>
is installed. For example,
        <blockquote>
          <pre>perl -e 'use Proc::Simple'<br></pre>
        </blockquote>
If it returns an error, then (<span style="font-weight: bold;">as root
user</span>) install it.
        <blockquote>
          <pre>perl -MCPAN -e 'install Proc::Simple'<br></pre>
        </blockquote>
      </li>
      <li>Load data into EMS/WMS tables to initialize.<br>
&nbsp;<br>
      </li>
    </ul>
  </li>
  <li>Configure <span style="font-family: monospace;">$MEME_HOME/bin/cronvalidate.csh</span>.&nbsp;
This script is intended to be set up as a cron job to run QA on a
weekly basis.&nbsp; It assumes no environment and so must be properly
configured to run.&nbsp; Set $ORACLE_HOME and $CGI_DIR<br>
    <br>
  </li>
  <li>Start the MEME server. First, edit <tt>$MEME_HOME/bin/meme_server.sh</tt>
and set <tt>$ORACLE_HOME</tt> properly. Then, the server can be
started with a command like this:
    <blockquote>
      <pre>$MEME_HOME/bin/meme_server.sh start &lt;port&gt; &lt;machine&gt;_&lt;sid&gt; $MEME_HOME<br></pre>
    </blockquote>
OR it can be done from the web page (if the target machine supports
rsh). See the local apelon index page and look for "Server Life
Cycle".&nbsp;</li>
</ol>
<h3><a name="updating"></a>Updating MEME code</h3>
When new versions of MEME code are available, here are the
steps to use to make sure everything is properly updated.
These steps should be performed on the target machine. These
steps assume that a <span style="font-family: monospace;">
meme.zip</span> has been produced that contains all update files.
<ol>
  <li> Copy <span style="font-family: monospace;">meme.zip</span> to
your local machine and unzip it in your <span
 style="font-family: monospace;">$MEME_HOME</span> directory. </li>
  <br>
  <li>If schema scripts PL/SQL packages were updated, reload them. For
example,
    <blockquote>
      <pre>sqlplus user/pwd@db &lt;&lt; EOF<br>@$MEME_HOME/sql/table_updates<br>@$MEME_HOME/sql/index_updates<br>@$MEME_HOME/sql/views<br>@$MEME_HOME/sql/synonyms<br>@$MEME_HOME/sql/packages<br>EOF<br></pre>
    </blockquote>
  </li>
c<br>
  <li>If your <span style="font-family: monospace;">/etc/umls/mid-services</span>
file changed, restart the server. For example,
    <blockquote>
      <pre>kill -HUP `ps -ef | grep inetd | grep -v grep | perl -pe 's/[ \t]+/\|/g' | cut -d\| -f 3`<br></pre>
    </blockquote>
  </li>
  <br>
  <li>If <span style="font-family: monospace;">$MEME_HOME/bin/meme.prop</span>
was updated, reconfigure the properties for the local machine. For
example,
    <blockquote>
      <pre>meme.mid.service.host=&lt;machine name, e.g. cbiodev108.nci.nih.gov&gt;<br>meme.mid.service.port=5125<br>meme.smtp.host=&lt;machine name&gt;<br>meme.client.server.host=&lt;machine name&gt;<br>meme.env.MEME_HOME=&lt;$MEME_HOME&gt;<br>meme.env.ORACLE_HOME=&lt;$ORACLE_HOME&gt;<br></pre>
    </blockquote>
  </li>
  <br>
  <li>Put <span style="font-family: monospace;">$MEME_HOME/java/meme.jar</span>
and <span style="font-family: monospace;">$MEME_HOME/bin/meme.prop</span>
in needed places. For example,
    <blockquote>
      <pre>/bin/cp -f $MEME_HOME/java/meme.jar $MEME_HOME/www/jaws/jekyll/lib/meme.jar<br>/bin/cp -f $MEME_HOME/java/meme.jar $MEME_HOME/webapps-meme/WEB-INF/lib/meme.jar<br>/bin/cp -f $MEME_HOME/java/meme.jar $MEME_HOME/webapps-mrd/WEB-INF/lib/meme.jar<br><br>/bin/cp -f $MEME_HOME/bin/meme.prop $MEME_HOME/www/MEME4/Data/meme.prop<br>/bin/cp -f $MEME_HOME/bin/meme.prop $MEME_HOME/webapps-meme/WEB-INF/classes/meme.prop<br>/bin/cp -f $MEME_HOME/bin/meme.prop $MEME_HOME/webapps-mrd/WEB-INF/classes/mrd.prop<br>/bin/rm -r -f /tmp/bundles /tmp/meme.prop<br>mkdir /tmp/bundles<br>/bin/cp $MEME_HOME/bin/meme.prop /tmp/bundles<br>/bin/cp $MEME_HOME/bin/meme.prop /tmp<br>pushd /tmp<br>jar -cvf $MEME_HOME/www/jaws/jekyll/lib/config.jar bundles/meme.prop meme.prop<br>popd<br>/bin/rm -r -f /tmp/bundles /tmp/meme.prop<br></pre>
    </blockquote>
  </li>
  <br>
  <li>Prep Jekyll JNLP. Run <span style="font-family: monospace;">$MEME_HOME/www/jaws/jekyll/makejnlp.csh</span>
to sign the necessary jar files. </li>
  <br>
  <li>If there is a new version of LVG, </li>
  <a href="#lvg">follow the instructions above</a>. However, use
current version of LVG instead of just "lvg2005". Make sure to kill and
restart the LVG server. <br>
  <li>If CGI scripts changed, reconfigure with proper <span
 style="font-family: monospace;">$MEME_HOME</span> and <span
 style="font-family: monospace;">$ORACLE_HOME</span> settings. For
example,
    <blockquote>
      <pre>% $MEME_HOME/bin/replace.pl '/d1/app/oracle/product/8.1.7' "$ORACLE_HOME" *<br>% $MEME_HOME/bin/replace.pl '/d5/MEME4' "$MEME_HOME" *<br>% chmod 755 *cgi<br></pre>
    </blockquote>
  </li>
  <br>
  <li>Restart the MEME4 server. Can be done with a command like this:
    <blockquote>
      <pre>$MEME_HOME/bin/meme_server.sh stop &lt;port&gt; X $MEME_HOME<br>$MEME_HOME/bin/meme_server.sh start &lt;port&gt; &lt;machine&gt;_&lt;sid&gt; $MEME_HOME<br></pre>
    </blockquote>
OR it can be done from the web page (if the target machine supports
rsh). See the local apelon index page and look for "Server Life Cycle".
  </li>
</ol>
<br>
<h3><a name="processes"></a>MEME Processes<br>
</h3>
The following MEME processes should be running at all times to
ensure availability of MEME services. It is recommended that these not
run as the root user.<br>
<ul>
  <li>MEME Server</li>
  <ul>
    <li>This is the java MEME application server.<br>
    </li>
  </ul>
  <ul>
    <li>It can be started from the <a
 href="/webapps-meme/meme/controller?state=ServerLifeCycle">server life
cycle page</a></li>
    <li>or it can be started by a call to <span
 style="font-family: monospace;">$MEME_HOME/bin/start.pl</span></li>
    <li>or it can be started by a call to <span
 style="font-family: monospace;">$MEME_HOME/bin/meme_server.sh</span>
(wrapper around <span style="font-family: monospace;">start.pl</span>)<br>
    </li>
  </ul>
  <li>LVG Server</li>
  <ul>
    <li>This is a wrapper around LVG calls that can be directly
accessed by MEME.&nbsp; <br>
    </li>
    <li>It is used to normalize new strings being inserted into the MID
by Jekyll.</li>
    <li>It is also used to perform normalized string searches in the
MID.</li>
    <li>It can be started by a call to <span
 style="font-family: monospace;">/site/umls/lvg/hsqldbserver/LVGServer.pl
-p 16001</span></li>
    <li>It assumes <span style="font-family: monospace;">/site/package/lvg/current</span>
is properly installed.<br>
    </li>
  </ul>
  <li>MID Services</li>
  <ul>
    <li>This is a key/value lookup service used by MEME. <br>
    </li>
    <li>It reports those key/value pairs expressed in <span
 style="font-family: monospace;">/etc/umls/mid-services</span><br>
    </li>
    <li>It is run as an <span style="font-family: monospace;">inetd</span>
process.</li>
    <li>Once the /etc/inetd.conf and <span
 style="font-family: monospace;">/etc/services</span> files are
properly configured, the <span style="font-family: monospace;">inetd</span>
process can be prodded to activate the service (<a href="#mid-services">see
above</a>)</li>
  </ul>
</ul>
<br>
<h3><a name="qa"></a>Post-installation QA Checklist<br>
</h3>
The following checklists document post-installation QA procedures to
ensure both MEME functions as expected on the database action and Web application
level.<br>
<ul>
  <li><a href="apelon_web_app_checklist.doc">Web application Checklist</a><br>
  </li>
  <li><a href="apelon_meme_action_checklist.doc">MEME Database Action
Checklist</a><br>
  </li>
</ul>
<hr width="100%">
<table nosave="" border="0" cols="2" width="100%">
  <tbody>
    <tr>
      <td align="left" valign="top">
      <address> &nbsp;</address>
      </td>
      <td align="right" valign="top">
      <address> Contact: <a href="mailto:bcarlsen@apelon.com">Brian A.
Carlsen</a></address>
      <address> Created: 12/14/2004</address>
      <address> Last Updated: 06/27/2005</address>
      </td>
    </tr>
  </tbody>
</table>
<!-- These comments are used by the What's new Generator --><!-- Changed On: 2005/06/27 --><!-- Changed by: BAC --><!-- Change Note: MEME4 INSTALLATION --><!-- Fresh for: 1 month -->
</body>
</html>
